<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Keyple extension for smart card solutions | Calypso Networks Association Keyple Support</title><link>https://keyple-support.calypsonet.org/add-ons/card-ext/</link><atom:link href="https://keyple-support.calypsonet.org/add-ons/card-ext/index.xml" rel="self" type="application/rss+xml"/><description>Keyple extension for smart card solutions</description><generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><image><url>https://keyple-support.calypsonet.org/media/logo.svg</url><title>Keyple extension for smart card solutions</title><link>https://keyple-support.calypsonet.org/add-ons/card-ext/</link></image><item><title>CNA member Keyple extension to manage contactless memory ticket solutions</title><link>https://keyple-support.calypsonet.org/add-ons/card-ext/storage-card/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://keyple-support.calypsonet.org/add-ons/card-ext/storage-card/</guid><description>&lt;br>
&lt;p>For a long time, the Calypso card product range was limited to â€˜Calypso Primeâ€™, in order to cater for season ticket holders and regular travellers. But to manage &amp;lsquo;occasional&amp;rsquo; travelers with single or limited-use card products, many ticketing systems used contactless memory ticketing solutions (such as &lt;strong>Mifare UltraLight&lt;/strong>, &lt;strong>CT512&lt;/strong>, &lt;strong>ST25&lt;/strong>) in addition to Calypso cards. Since then, the Calypso card range has been expanded with the Calypso Light and Calypso Basic solutions.
Pending migration to support Light and Basic products, many ticketing systems still require their terminals to handle Calypso cards alongside contactless memory ticket solutions.&lt;/p>
&lt;p>To assist CNA members and facilitate the management of contactless memory tickets on Calypso terminals based on the Keyple middleware: &lt;strong>CNA offers its members the privilege of benefiting from libraries enabling them to process contactless memory tickets on Keyple-based terminal&lt;/strong>.&lt;/p>
&lt;ul>
&lt;li>ðŸŒ All the APIs needed to support memory tickets are open source and hosted by the Keypop and Keyple projects.&lt;/li>
&lt;li>ðŸŒ CNA also offers open source examples of contactless memory ticket processing.&lt;/li>
&lt;li>ðŸš« Only CNA members can benefit from CNA libraries supporting contactless memory ticket processing.&lt;/li>
&lt;/ul>
&lt;p>$\text{\color{red}This is the first solution to easily operate proprietary contactless memory ticket solutions on a Keyple terminal. It is possible that it may lack useful features for your needs: if this is the case, don&amp;rsquo;t hesitate to report it to CNA (potentially through issues on the relevant repositories).}$&lt;/p>
&lt;h2 id="involved-software-components">Involved software components&lt;/h2>
&lt;p>In addition to the &lt;a href="https://keyple.org/components/overview/components-map/" target="_blank" rel="noopener">Keyple global component dependency guide&lt;/a>, the diagram below focuses on the components involved in handling contactless memory tickets.
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="../../media/cna-storagecard-support/storagecard_component_dependencies.svg" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="terminal-interface-to-drive-a-transaction-with-contactless-memory-tickets">Terminal Interface to drive a transaction with contactless memory tickets&lt;/h2>
&lt;p>In order to facilitate the design of ticketing processing on a terminal interacting with contactless memory tickets, CNA has defined a dedicated universal interface: the &lt;a href="https://terminal-api.calypsonet.org/specifications/card-layer-storagecard/storagecard-api/" target="_blank" rel="noopener">Storage Card API&lt;/a>.&lt;/p>
&lt;h2 id="keypop-api-to-drive-a-transaction-with-contactless-memory-tickets">Keypop API to drive a transaction with contactless memory tickets&lt;/h2>
&lt;p>An open source &lt;a href="https://keypop.org/apis/card-layer-storagecard/storagecard-api/" target="_blank" rel="noopener">Java translation of the Storage Card API&lt;/a> definition has been released within the Eclipse Keypop project.&lt;/p>
&lt;h2 id="cna-library-to-process-contactless-memory-tickets">CNA Library to process contactless memory tickets&lt;/h2>
&lt;p>In order to assist CNA members who need to combine Calypso card processing with contactless memory ticket processing on their Keyple-based ticketing terminals, CNA provides its members with a dedicated card extension: the &lt;a href="https://github.com/calypsonet/keyple-card-cna-storagecard-java-lib" target="_blank" rel="noopener">CNA Storage Card Lib&lt;/a>.&lt;/p>
&lt;h2 id="reader-support-for-contactless-memory-tickets">Reader support for contactless memory tickets&lt;/h2>
&lt;p>To integrate smart card reader solutions with the Keyple middleware in a generic way, until now the Keyple project offered a simple plugin interface&lt;/p>
&lt;ul>
&lt;li>This &lt;a href="https://keyple.org/components/core/keyple-plugin-api/" target="_blank" rel="noopener">Keyple Plugin API&lt;/a> needs to be implemented by a specific plugin for the various reader solutions.&lt;/li>
&lt;li>A &lt;a href="https://keyple.org/learn/developer-guide/reader-plugin-add-on/" target="_blank" rel="noopener">guide to developing plugins&lt;/a> for reader solutions is also provided by the Keyple project.&lt;/li>
&lt;/ul>
&lt;p>Proprietary contactless ticket solutions do not support the level 4 of the ISO 14443 standard: these solutions are therefore not compatible with the â€œAPDU commandâ€ envelope format defined by the ISO 7816-4 standard. Communication with contactless tickets therefore relies on exchanges of non-standardized â€œbyte blocksâ€: specific processing by reader solutions is required to handle memory tickets.&lt;/p>
&lt;h3 id="native-support-of-contactless-memory-tickets-by-pcsc-readers">Native support of contactless memory tickets by PC/SC readers&lt;/h3>
&lt;p>The PC/SC standard has defined an &lt;a href="https://pcscworkgroup.com/Download/Specifications/pcsc3_v2.01.09.pdf" target="_blank" rel="noopener">APDU &amp;lsquo;Storage Card&amp;rsquo; envelope format&lt;/a> to standardize the way data blocks are exchanged with contactless memory tickets. This envelope format is used by the Storage Card library proposed by CNA.
Thus, the &lt;a href="https://keyple.org/components/standard-reader-plugins/keyple-plugin-pcsc-lib/" target="_blank" rel="noopener">PC/SC plugin&lt;/a> proposed by the Keyple project is natively compliant to support communication with contactless memory tickets.&lt;/p>
&lt;h3 id="keyple-interface-for-extending-a-plugin-to-manage-memory-ticket-command-wrapping">Keyple interface for extending a plugin to manage memory ticket command wrapping&lt;/h3>
&lt;p>To support contactless memory tickets on Keyple terminals using reader solutions other than PC/SC, the reader plugin needs to manage the APDU wrapping of command blocks specific to contactless ticket solutions.
To facilitate and factorize the integration of APDU wrapping for plugins for reader solutions other than PC/SC, the Keyple project offers an additional API: the &amp;lsquo;&lt;a href="https://keyple.org/components/core/keyple-plugin-storagecard-api/" target="_blank" rel="noopener">Plugin Storage Card API&lt;/a>&amp;rsquo;.&lt;/p>
&lt;p>A reader plugin that uses this API can then be extended to support contactless memory tickets if it is interfaced with a library implementing this API.&lt;/p>
&lt;ul>
&lt;li>In the Keyple project, the &lt;a href="https://github.com/eclipse-keyple/keyple-plugin-android-nfc-java-lib/tree/storage-card-api" target="_blank" rel="noopener">Android NFC plugin&lt;/a> has been updated to use this interface, enabling an NFC reader to integrate support for Mifare UltraLight tickets (as CT512 or ST25 products are not part of the NFC standard). (feature currently available in the â€˜storage-card-apiâ€™ branch, integration in progress in the main branch)&lt;/li>
&lt;li>Among the Keyple &amp;lsquo;add-ons&amp;rsquo; offered by CNA, the open source &lt;a href="https://github.com/calypsonet/keyple-plugin-cna-bluebird-specific-nfc-java-lib/tree/storagecard" target="_blank" rel="noopener">plugin for Bluebird readers&lt;/a> has also evolved to use this API and thus support Mifare UL, CT512, and ST25 tickets (feature currently available in the â€˜storagecardâ€™ branch, integration in progress in the main branch)&lt;/li>
&lt;/ul>
&lt;h3 id="cna-library-to-add-contactless-memory-ticket-command-wrapping-to-keyple-plugins">CNA Library to add contactless memory ticket command wrapping to Keyple plugins&lt;/h3>
&lt;p>To assist CNA members needing to integrate contactless memory ticket processing on a Keyple-based terminal with readers other than PC/SC: CNA provides a members-only library that enables APDU wrapping of ticket commands to be integrated into a Keyple plugin: the &lt;a href="https://github.com/calypsonet/keyple-plugin-cna-storagecard-java-lib" target="_blank" rel="noopener">Plugin Storage Card library&lt;/a>.&lt;/p>
&lt;h2 id="examples-of-contactless-memory-ticket-processing-in-a-terminal-application">Examples of contactless memory ticket processing in a terminal application&lt;/h2>
&lt;p>The Keyple project hosts basic examples in &lt;a href="https://github.com/eclipse-keyple/keyple-java-example" target="_blank" rel="noopener">Java&lt;/a> and &lt;a href="https://github.com/eclipse-keyple/keyple-cpp-example" target="_blank" rel="noopener">C++&lt;/a> showing how to implement Keyple components. CNA offers complementary &lt;a href="https://github.com/calypsonet/keyple-cna-java-example" target="_blank" rel="noopener">basic Java examples&lt;/a>, including one dedicated to the processing of contactless memory tickets on a PC terminal equipped with PC/SC readers.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/calypsonet/keyple-cna-java-example/tree/main/storagecard-pcsc" target="_blank" rel="noopener">contactless ticket processing on a PC/SC reader&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>All the applications of the CNA advanced ticketing demonstrator will be updated to integrate the processing of contactless ticketing solutions in addition to Calypso cards.&lt;/p>
&lt;ul>
&lt;li>The first application to integrate this support is the distributed ticket reloading service (for the time being in the &amp;lsquo;storagecard&amp;rsquo; branch).
&lt;ul>
&lt;li>&lt;a href="https://github.com/calypsonet/keyple-demo-ticketing-reloading-remote/blob/storagecard/client/keyple-mobile-android/app/src/main/kotlin/org/calypsonet/keyple/demo/reload/remote/domain/TicketingService.kt#L65" target="_blank" rel="noopener">contactless ticket memory selection&lt;/a> on a distributed reload local client.&lt;/li>
&lt;li>&lt;a href="https://github.com/calypsonet/keyple-demo-ticketing-reloading-remote/blob/storagecard/server/src/main/java/org/calypsonet/keyple/demo/reload/remote/server/card/CardRepository.java#L207" target="_blank" rel="noopener">contactless memory ticket data writing&lt;/a> managed by a distributed remote server.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item></channel></rss>